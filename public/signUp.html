<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="bootstrap-3.3.7-dist/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="./style/stylesheet.css">
    <link rel="stylesheet" type="text/css" href="./style/style.css">
    <script type="text/javascript" src="homepage.js"></script>
</head>

<body>
    <div class="container col-sm-12">
        <div class="row main col-sm-12">
            <div class="logo">
                <img class="logo" src="assets/MyMedicine.png">
            </div>
            <div class="panel-heading">
                <div class="panel-title text-center">
                    <h1 class="title">MyMedicine</h1>
                    <hr />
                </div>
            </div>
            <div class="main-login main-center col-sm-12">
                <form method="post" class="form-signup" id="signup">
                    <h2 class="form-signup-heading">Create Account</h2>
                    <label for="username" class="sr-only">Name</label>
                    <input name="name" type="text" id="username" class="form-control" placeholder="username" required autofocus>
                    <label for="username" class="sr-only">Username</label>
                    <input name="email" type="email" id="Email" class="form-control" placeholder="Email address" required autofocus>
                    <label for="inputPhoneNumber" class="sr-only">Phone Number</label>
                    <input name="phone" type="phonenumber" id="inputPhoneNumber" class="form-control" placeholder="Phone Number" required autofocus>
                    <label for="inputPassword" class="sr-only">Password</label>
                    <input name="password" type="password" id="Password" class="form-control" placeholder="Password" required>
                    <!-- <button class="btn btn-lg btn-primary btn-block" type="submit">Sign Up</button> -->
                    <input class="btn btn-lg btn-primary btn-block" type="submit" value="Submit Form" />
                    <a href="SignIn.html">Do you have an account? Sign in.</a>
                </form>

            </div>
        </div>
    </div>
    </div>
    </div>
    </div>
    <script>
        const form = document.getElementById('signup')
        form.addEventListener('submit', registerUser)

        async function registerUser(event) {
            event.preventDefault()
            const email = document.getElementById('Email').value
            const password = document.getElementById('Password').value
            const username = document.getElementById('username').value
            const PhoneNumber = document.getElementById('inputPhoneNumber').value
            const result = await fetch('/api/register', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    email,
                    password,
                    username,
                    PhoneNumber
                })
            }).then((res) => res.json())

            if (result.status === 'ok') {
                window.location.href = "./SignIn.html"
            } else {
                alert(result.error)
            }
        }
    </script>
</body>

</html>